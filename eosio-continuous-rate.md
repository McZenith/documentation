# EOSIO 的连续通胀率 4.879% 是怎么算出来的？

> 作者: UMU @ MEET.ONE 实验室

## 问题

在 `eosio.contracts/eosio.system/src/producer_pay.cpp` 中有这样一行代码：

```
const double   continuous_rate       = 0.04879;          // 5% annual rate
```

搜索一下，会得到这样的解释：

> EOS是连续增发的模式，连续通胀率是 4.879%，年度通胀是 5%；

> 运用微积分的知识，可以推导出来，假设是增发的次数是无限多次，那么，连续通胀的情景下，所设置的连续通胀率就是 4.879%。

然而，并没有解释具体算法……

## 求解

### 高中版

以下做个简单的推理：

- `continuous_rate` 在 `claimrewards` 函数中被使用，而此函数被调用的频率是每天。

- 所以，0.04879 可能是个“每日结算的”年化率，即：

```
(1 + 0.04879 / 365) ^ 365 = 1.05

注：这里的 ^ 表示幂，不是 XOR 运算。
```

数值对上了，所以我们的推理正确！那么我们计算 `continuous_rate` 的公式就是：

```
[365TH_ROOT(1 + annual_rate) - 1] * 365

注：365TH_ROOT 是开 365 次方
```

把 5% 带入，计算结果是：`0.048793425246406`。其中运用的数学知识只到高中水平，并没有什么微积分的知识。

只有实时增发（次数是无限多次），才需要用到微积分，但 EOS 并没必要这么干。

### 大学版

基于专研精神，我们也来微积分一下：

问题本质：已知 annuyl_rate、`(1 + continuous_rate / N) ^ N = 1 + annuyl_rate`，求 continuous_rate 在 N 为无穷大时的解。

上面我们已经把 N = 365 的解求出来了，但现在是 ∞，高中数学是不够用了。复习一下大学数学，马上就会发现 `lim N->∞ (1 + x / N) ^ N` 就是 `e ^ x` 的定义，所以：

```
continuous_rate = ln(1 + annuyl_rate)
```

把 5% 代入 annuyl_rate，`continuous_rate = 0.048790164169432`

## 相关信息

MEET.ONE 的侧链会将年度通胀更合理地定义为 1%，所以按照我们上面的算法，`continuous_rate` 将为：

```
[365TH_ROOT(1 + 0.01) - 1] * 365 = 0.009950466483283

ln(1 + 0.01) = 0.009950330853168
```

即 0.995%。
